<div class="filters">

{{/* Reusable filter block. Expects a dict with keys: "Key" (category key) and "Filters" (map passed from parent) */}}
{{ define "filter-block" }}
    <div class="mb-3">
        <div class="filter-collapse">
            <button class="btn btn-outline-secondary w-100 d-flex align-items-center justify-content-between" type="button" data-bs-toggle="collapse" data-bs-target="#collapse{{ .Key }}" aria-expanded="false" aria-controls="collapse{{ .Key }}">
                <span class="d-flex align-items-center gap-2"><svg class="icon text-{{ getCategoryDataKey .Key "Color"}}"><use href="icons.svg#{{ getCategoryDataKey .Key "Icon" }}"></use></svg>&nbsp;&nbsp;{{ .Key }}<span class="badge bg-secondary filter-badge" data-filter-key="{{ .Key }}"></span></span>
                <i class="bi bi-chevron-down"></i>
            </button>
            <div class="collapse mt-2" id="collapse{{ .Key }}" data-bs-parent=".filters">
                <div class="d-flex flex-wrap p-2 w-100" style="max-height:240px; overflow:auto;">
                    {{- $cat := .Key }}
                    {{- range $item := index .Filters $cat }}
                    <div class="form-check mx-1 my-1">
                        <input class="form-check-input css-checkbox" type="checkbox" value="{{$cat}}#{{ $item }}" id="{{$cat}}#{{ $item }}">
                        <label class="form-check-label" for="{{$cat}}#{{ $item }}">{{ $item }}</label>
                    </div>
                    {{- end }}
                </div>
            </div>
        </div>
    </div>
{{ end }}

{{/* Render each category using the reusable block to keep ordering explicit */}}
{{ template "filter-block" dict "Key" "Brand" "Filters" . }}
{{ template "filter-block" dict "Key" "Group" "Filters" . }}
{{ template "filter-block" dict "Key" "Color" "Filters" . }}
{{ template "filter-block" dict "Key" "Base" "Filters" . }}
{{ template "filter-block" dict "Key" "Stickers" "Filters" . }}
{{ template "filter-block" dict "Key" "Texture" "Filters" . }}
{{ template "filter-block" dict "Key" "View360" "Filters" . }}
{{ template "filter-block" dict "Key" "Tags" "Filters" . }}

</div>