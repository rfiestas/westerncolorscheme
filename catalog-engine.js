var filtersData={},colorSchemaData={};function updateFilterBadges(){const t=document.querySelectorAll(".form-check-input"),n=document.querySelectorAll(".filter-badge"),e={};t.forEach(t=>{if(t.checked){const n=t.value.split("#")[0];e[n]=(e[n]||0)+1}}),n.forEach(t=>{const s=t.getAttribute("data-filter-key"),n=e[s]||0;t.textContent=n,t.style.display=n>0?"inline-block":"none"})}document.addEventListener("DOMContentLoaded",function(){const e=document.getElementById("reset");e&&e.addEventListener("click",function(){const e=document.querySelectorAll(".form-check-input");e.forEach(e=>{e.checked=!1,e.dispatchEvent(new Event("change"))}),updateFilterBadges()});const t=document.querySelectorAll(".form-check-input");t.forEach(e=>{e.addEventListener("change",function(){const a=this.value.split("#")[0],n=document.querySelectorAll(`[data-${a}]`);updateFilterBadges();const s=Array.from(t).filter(e=>e.checked).map(e=>e.value);if(!s.length){document.getElementById("cube-summary").innerHTML=``,document.getElementById("modal-cube-summary").innerHTML=``,n.forEach(e=>e.classList.remove("visually-hidden"));return}var e={};s.forEach(t=>{var s=t.split("#"),n=s[0],o=s[1];n in e?e[n].push(o):e[n]=[o]});let o=0;n.forEach(t=>{var n,i,a,s=0;for(n in e){const o=t.dataset[n.toLowerCase()];if(!o)continue;o.includes(",")?(i=new Set([].concat(e[n],o.split(","))),a=[].concat(e[n],o.split(",")),i.size<a.length&&(s+=1)):e[n].includes(o)&&(s+=1)}s==Object.keys(e).length?(t.classList.remove("visually-hidden"),o++):t.classList.add("visually-hidden")});let i=" ("+resultsTemplate(Object.keys(e).length,"Filter")+", "+resultsTemplate(o,"Result")+")";document.getElementById("cube-summary").innerHTML=i,document.getElementById("modal-cube-summary").innerHTML=i})})}),document.getElementById("view360").addEventListener("hidden.bs.modal",function(){window.CI360.destroy()}),document.getElementById("view360").addEventListener("shown.bs.modal",function(){window.CI360.init()});function openView360(e,t){let s=`images/cubes/view-360/${e}-${t}/`;document.getElementById("view-label").innerHTML=`${e} ${t}`,document.getElementById("cube-360").setAttribute("data-folder",s);const n=document.getElementById("view360");if(n){const e=bootstrap.Modal.getOrCreateInstance(n);e.show()}}function resultsTemplate(e,t){let n="s";return e==1&&(n=""),`${e} ${t}${n}`}function view360Template(e,t,n){let s=getfilterDataKey("View360","Icon")+" text-"+getfilterDataKey("View360","Color");return e?`<a class="cube-list-favourite order-2" href="#View360/${t}-${n}" title="${t}-${n} 360 view" onclick="openView360('${t}', '${n}')"><i class="fas ${s}"></i></a>`:``}document.addEventListener("DOMContentLoaded",()=>{const t=document.querySelectorAll("[data-bg]"),e=new IntersectionObserver(t=>{t.forEach(t=>{if(!t.isIntersecting)return;const n=t.target,s=n.getAttribute("data-bg"),o=new Image;o.onload=()=>{n.style.backgroundImage=`url(${s})`},o.onerror=()=>{const e=s.indexOf("/images/");if(e!==-1){const t=s.substring(e);n.style.backgroundImage=`url(${t})`}},o.src=s,n.removeAttribute("data-bg"),e.unobserve(n)})},{rootMargin:"200px 0px"});t.forEach(t=>e.observe(t))}),document.addEventListener("DOMContentLoaded",()=>{document.querySelectorAll("img[data-cdn]").forEach(e=>{e.onerror=()=>{if(e.dataset.fallbackTried)return;e.dataset.fallbackTried="1";const t=e.getAttribute("src"),n=t.indexOf("/images/");n!==-1&&(e.src=t.substring(n))}})}),document.addEventListener("DOMContentLoaded",function(){const s=document.getElementById("catalog"),e=document.getElementById("btn-view-mode"),t=document.getElementById("btn-toggle-details"),n=document.getElementById("btn-compact-grid");if(!s||!e||!t||!n)return;function o(){document.querySelectorAll(".cube-list-details").forEach(function(e){e.classList.remove("d-none")}),s.classList.remove("grid-compact")}function i(){e.classList.remove("active"),t.classList.remove("active"),n.classList.remove("active")}e.addEventListener("click",function(){o(),i(),e.classList.add("active")}),t.addEventListener("click",function(){o(),i(),t.classList.add("active"),document.querySelectorAll(".cube-list-details").forEach(function(e){e.classList.add("d-none")})}),n.addEventListener("click",function(){o(),i(),n.classList.add("active"),s.classList.add("grid-compact"),document.querySelectorAll(".cube-list-details").forEach(function(e){e.classList.add("d-none")})}),e.classList.add("active")})